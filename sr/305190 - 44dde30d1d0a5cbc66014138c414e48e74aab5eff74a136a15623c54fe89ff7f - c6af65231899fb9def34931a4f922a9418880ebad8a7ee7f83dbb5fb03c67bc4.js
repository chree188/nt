'use strict';var poet=function(id,from,title,author,content){return JSON.stringify({id,from,title,author,content})};var PoetContract=function(){LocalContractStorage.defineMapProperty(this,'poets');LocalContractStorage.defineProperty(this,'count')};PoetContract.prototype={init:function(){this.count=0},search:function(title,author,content){title=title.trim();author=author.trim();content=content.trim();for(let i=0;i<this.count;i++){let item=JSON.parse(this.poets.get(i));if(item.title===title&&item.author===author||item.content===content){return true}}return false},add:function(title,author,content){let from=Blockchain.transaction.from;if(this.search(title,author,content)){return}this.poets.set(this.count,poet(this.count,from,title.trim(),author.trim(),content.trim()));this.count+=1},fetch:function(page,size,keyType,keywords){let list=[];let start=(page-1)*size;for(let i=this.count-1;i>=0;i--){let item=JSON.parse(this.poets.get(i));if(keyType&&item[keyType]&&item[keyType].toLowerCase().indexOf(keywords.toLowerCase())<0)continue;list.push(item)}let offset=page*size;return{list:list.slice(start,offset)}},len:function(){return this.count}};module.exports=PoetContract;